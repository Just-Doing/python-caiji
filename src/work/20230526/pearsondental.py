from itertools import product
import sys
from bs4 import BeautifulSoup
from selenium import webdriver
import time
import json
import re
sys.path.append('../..')
from lib import excelUtils
from lib import httpUtils
from lib import textUtil
from lib.htmlEleUtils import getNodeText
from lib.htmlEleUtils import getInnerHtml
products1 = []
products2 = []
customerHeader = []
sizeHeader=[]

def addHeader(header, title):
  if title not in header and len(title) > 0:
    header.append(title)


def getProductInfo(url, type1, type2):
	print(str(len(products1)) + "==" + url)
	sope = httpUtils.getHtmlFromUrl(url)
	ProductName = sope.find("div", attrs={"class":"product-heading"})

	pInfo = {
		"link": url,
		"Product type1": type1,
		"Product type2": type2,
		"Product type3": getNodeText(ProductName)
	}

	otherInfo = sope.find("div", attrs={"class":"product-description-section"})
	if otherInfo!=None:
		pInfo["features"] = getNodeText(otherInfo.find("ul"))
		pInfo["Product Description"] = getNodeText(otherInfo.find("p", attrs={"align":"JUSTIFY"}))
		
		strongs = otherInfo.find_all("strong")
		for strong in strongs:
			title = getNodeText(strong)
			if "Application" in title:
				pInfo["Application"] = getNodeText(strong.parent).replace("Application","").replace(":","")
		
		table = otherInfo.find("table")
		if table != None:
			trs = table.find_all("tr")
			trTitle = getNodeText(trs[0])
			if "PRODUCTS" in trTitle and "C. I. NAME" in trTitle and "CAS NO." in trTitle:
				tds = trs[0].find_all("td")
				productsIndex = 0
				CINAMEIndex = 0
				CASNOIndex = 0
				for inx,td in enumerate(tds):
					tdTitle = getNodeText(td)
					if tdTitle.lower() == "products":
						productsIndex = inx
					if tdTitle.lower() == "c. i. name":
						CINAMEIndex = inx
					if tdTitle.lower() == "cas no.":
						CASNOIndex = inx
				for inx, tr in enumerate(trs):
					if inx>0:
						dataTds = tr.find_all("td")
						products2.append( {
						"Product type1": type1,
						"Product type2": type2,
						"Product type3": getNodeText(ProductName),
						"PRODUCTS": getNodeText(dataTds[productsIndex]),
						"C. I. NAME": getNodeText(dataTds[CINAMEIndex]),
						"CAS NO.": getNodeText(dataTds[CASNOIndex])
					})
			

			trTds = trs[0].find_all("td")
			if len(trTds) == 2:
					for inx, tr in enumerate(trs):
						tds = tr.find_all("td")
						if len(tds) == 2:
							title = getNodeText(tds[0])
							value = getNodeText(tds[1])
							addHeader(headers, title)
							pInfo[title] = value



	products1.append(pInfo.copy())

def getProductList(url, type):
	htmlStr = '<ul>  <li class="has-sub"><span class="submenu-button"></span><a href="/reactive-dyes.html">Reactive Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/industrial-reactive-dyes-1634617.html">Industrial Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/bifunctional-reactive-dyes-1634615.html">Bifunctional Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/direct-reactive-dye-1634646.html">Direct Reactive Dye</a></li>  <li><a href="https://www.meghadyes.com/reactive-hot-dyes-1634616.html">Reactive Hot Dyes</a></li>  <li><a href="https://www.meghadyes.com/yellow-m4g-reactive-dyes-3109762.html">Yellow M4G Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-yellow-mg-3130145.html">Reactive Yellow MG</a></li>  <li><a href="https://www.meghadyes.com/bi-functional-me-series-dyes-1634611.html">Bi Functional ME Series Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-orange-86-3130057.html">Reactive Orange 86</a></li>  <li><a href="https://www.meghadyes.com/yellow-mgr-3112129.html">Yellow MGR</a></li>  <li><a href="https://www.meghadyes.com/reactive-orange-1-3130131.html">Reactive Orange 1</a></li>  <li><a href="https://www.meghadyes.com/yellow-color-reactive-dyes-3109761.html">Yellow Color Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/eco-friendly-reactive-dyes-1768925.html">Eco Friendly Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/m-cold-series-dyes-1634409.html">M Cold Series Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-dye-yellow-22-3112121.html">Reactive Dye Yellow 22</a></li>  <li><a href="https://www.meghadyes.com/golden-yellow-mr-3129974.html">Golden Yellow MR</a></li>  <li><a href="https://www.meghadyes.com/reactive-orange-14-3130098.html">Reactive Orange 14</a></li>  <li><a href="https://www.meghadyes.com/reactive-yellow-m4r-3130120.html">Reactive Yellow M4R</a></li>  <li><a href="https://www.meghadyes.com/reactive-yellow-m3r-3130070.html">REACTIVE YELLOW M3R</a></li>  <li><a href="https://www.meghadyes.com/highly-exhausted-dyes-1634412.html">Highly Exhausted Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-dyes-1599967.html">Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/fabric-reactive-dyes-1634623.html">Fabric Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/liquid-reactive-dyes-1634411.html">Liquid Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-yellow-44-3130024.html">Reactive Yellow 44</a></li>  <li><a href="https://www.meghadyes.com/vinyl-sulphone-dyes-1634614.html">Vinyl Sulphone Dyes</a></li>  <li><a href="https://www.meghadyes.com/multi-color-reactive-dyes-1634649.html">Multi Color Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/yellow-m8g-reactive-dyes-3109707.html">Yellow M8G Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-dyes-yellow-7-3114608.html">Reactive Dyes Yellow 7</a></li>  <li><a href="https://www.meghadyes.com/m-cold-series-reactive-dyes-6952207.html">M Cold Series Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/h-cold-series-reactive-dyes-6952208.html">H Cold Series Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/highly-exhausted-reactive-dyes-6952209.html">Highly Exhausted Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/bi-functional-me-series-reactive-dyes-6952210.html">Bi Functional ME Series Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/purple-h3r-reactive-dyes-6952211.html">Purple H3R Reactive Dyes</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/direct-dyes.html">Direct Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/direct-dyes-5221178.html">Direct Dyes</a></li>  <li><a href="https://www.meghadyes.com/optimum-quality-direct-dyes-1599962.html">Optimum Quality Direct Dyes</a></li>  <li><a href="https://www.meghadyes.com/direct-black-dyes-2218746.html">Direct Black Dyes</a></li>  <li><a href="https://www.meghadyes.com/direct-black-5221226.html">Direct Black</a></li>  <li><a href="https://www.meghadyes.com/industrial-direct-dyes-2218731.html">Industrial Direct Dyes</a></li>  <li><a href="https://www.meghadyes.com/lemon-chrome-pigment-6952213.html">Lemon Chrome Pigment</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/acid-dyes.html">Acid Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/inkjet-dyes-5039966.html">Inkjet Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-milling-dyes-1634654.html">Acid Milling Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-multi-color-dyes-1634659.html">Acid Multi Color Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-dyes-5221179.html">Acid Dyes</a></li>  <li><a href="https://www.meghadyes.com/industrial-grade-acid-dye-1599961.html">Industrial Grade Acid Dye</a></li>  <li><a href="https://www.meghadyes.com/acid-metal-complex-dyes-6952214.html">Acid Metal Complex Dyes</a></li>  <li><a href="https://www.meghadyes.com/fluorescent-dye-6952215.html">Fluorescent Dye</a></li>  <li><a href="https://www.meghadyes.com/fabric-brightner-6952216.html">Fabric Brightner</a></li>  <li><a href="https://www.meghadyes.com/dyeing-chemical-6952217.html">Dyeing Chemical</a></li>  <li><a href="https://www.meghadyes.com/acid-orange-6952218.html">Acid Orange</a></li>  <li><a href="https://www.meghadyes.com/solvent-soluble-dye-6952219.html">Solvent Soluble Dye</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/hair-dyes-.html">Hair Dyes </a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/basic-brown-17-hair-dyes-1765366.html">Basic Brown 17 Hair Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-red-76-hair-dyes-1765371.html">Basic Red 76 Hair Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-orange-31-hair-dye-1765375.html">Basic Orange 31 Hair Dye</a></li>  <li><a href="https://www.meghadyes.com/para-phenyldiamine-1765378.html">Para Phenyldiamine</a></li>  <li><a href="https://www.meghadyes.com/basic-brown-16-hair-dye-5039727.html">Basic Brown 16 Hair Dye</a></li>  <li><a href="https://www.meghadyes.com/2-nitro-para-phenyldiamine-1765386.html">2 Nitro Para Phenyldiamine</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/mordant-dyes.html">Mordant Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/mordant-yellow-12-dyes-2622662.html">Mordant Yellow 12 Dyes</a></li>  <li><a href="https://www.meghadyes.com/lake-quinoline-yellow-2622668.html">Lake Quinoline Yellow</a></li>  <li><a href="https://www.meghadyes.com/lake-sunset-yellow-2622660.html">Lake Sunset Yellow</a></li>  <li><a href="https://www.meghadyes.com/mordant-yellow-3-dyes-2622659.html">Mordant Yellow 3 Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-mordant-dyes-1599964.html">Acid Mordant Dyes</a></li>  <li><a href="https://www.meghadyes.com/mordant-yellow-8-dyes-2622661.html">Mordant Yellow 8 Dyes</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/solvent-dyes.html">Solvent Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/solvent-dyes-1599965.html">Solvent Dyes</a></li>  <li><a href="https://www.meghadyes.com/solvents-yellow-dyes-2-rls-2624910.html">Solvents Yellow Dyes 2 RLS</a></li>  <li><a href="https://www.meghadyes.com/solvent-black-dyes-2624922.html">Solvent Black Dyes</a></li>  <li><a href="https://www.meghadyes.com/solvents-orange-dyes-2r-2624976.html">Solvents Orange Dyes 2R</a></li>  <li><a href="https://www.meghadyes.com/solvents-black-rl-dye-2624936.html">Solvents Black Rl Dye</a></li>  <li><a href="https://www.meghadyes.com/solvent-brown-41-2624947.html">Solvent Brown 41</a></li>  <li><a href="https://www.meghadyes.com/solvents-yellow-r-dye-2624967.html">Solvents Yellow R Dye</a></li>  <li><a href="https://www.meghadyes.com/solvent-orange-54-2624961.html">Solvent Orange 54</a></li>  <li><a href="https://www.meghadyes.com/solvent-orange-2624923.html">Solvent Orange</a></li>  <li><a href="https://www.meghadyes.com/solvents-blue-dyes-2-gln-2624929.html">Solvents Blue Dyes 2 GLN</a></li>  <li><a href="https://www.meghadyes.com/solvents-black-rbl-dye-2624921.html">Solvents Black RBL Dye</a></li>  <li><a href="https://www.meghadyes.com/solvents-red-b-dye-2624940.html">Solvents Red B Dye</a></li>  <li><a href="https://www.meghadyes.com/solvents-pink-dyes-5blg-2624924.html">Solvents Pink Dyes 5BLG</a></li>  <li><a href="https://www.meghadyes.com/solvent-orange-dyes-2624913.html">Solvent Orange Dyes</a></li>  <li><a href="https://www.meghadyes.com/solvents-fire-red-g-dye-2625328.html">Solvents Fire Red G Dye</a></li>  <li><a href="https://www.meghadyes.com/lake-chocolate-brown-ht-2624914.html">Lake Chocolate Brown HT</a></li>  <li><a href="https://www.meghadyes.com/solvent-red-dyes-2624925.html">Solvent Red Dyes</a></li>  <li><a href="https://www.meghadyes.com/solvents-yellow-gl-dyes-2624912.html">Solvents Yellow Gl Dyes</a></li>  <li><a href="https://www.meghadyes.com/solvents-orange-r-dyes-2625204.html">Solvents Orange R Dyes</a></li>  <li><a href="https://www.meghadyes.com/solvents-fire-red-gls-dyes-2625220.html">Solvents Fire Red GLS Dyes</a></li>  <li><a href="https://www.meghadyes.com/solvent-green-5053234.html">Solvent Green</a></li>  <li><a href="https://www.meghadyes.com/solvent-yellow-dyes-5056472.html">Solvent Yellow Dyes</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/basic-dyes.html">Basic Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/basic-voilet-dyes-2620874.html">Basic Voilet Dyes</a></li>  <li><a href="https://www.meghadyes.com/gentian-violet-dye-2618784.html">Gentian Violet Dye</a></li>  <li><a href="https://www.meghadyes.com/basic-violet-1-liquid-dyes-2618786.html">Basic Violet 1 Liquid Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-black-dyes-2618787.html">Basic Black Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-orange-dyes-2620839.html">Basic Orange Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-violet-dyes-2618785.html">Basic Violet Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-brown-dyes-2620859.html">Basic Brown Dyes</a></li>  <li><a href="https://www.meghadyes.com/bismark-brown-rg-dyes-2620869.html">Bismark Brown RG Dyes</a></li>  <li><a href="https://www.meghadyes.com/liquid-dyes-1765403.html">Liquid Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-green-dyes-2618783.html">Basic Green Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-blue-dyes-2618782.html">Basic Blue Dyes</a></li>  <li><a href="https://www.meghadyes.com/liquid-basic-dyes-1599963.html">Liquid Basic Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-dyes-5060165.html">Basic Dyes</a></li>  <li><a href="https://www.meghadyes.com/colorants-for-coolant-and-engine-oil-6952228.html">Colorants for Coolant and Engine Oil</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/dyes.html">Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/naphthol-dyes-1637711.html">Naphthol Dyes</a></li>  <li><a href="https://www.meghadyes.com/1-1-metal-complex-dyes-1768890.html">1:1 Metal Complex Dyes</a></li>  <li><a href="https://www.meghadyes.com/salt-free-dyes-1599968.html">Salt Free Dyes</a></li>  <li><a href="https://www.meghadyes.com/leather-dyes-1765435.html">Leather Dyes</a></li>  <li><a href="https://www.meghadyes.com/indigo-vat-dyes-1637713.html">Indigo Vat Dyes</a></li>  <li><a href="https://www.meghadyes.com/fast-salt-dyes-1637718.html">Fast Salt Dyes</a></li>  <li><a href="https://www.meghadyes.com/indigo-carmine-1634749.html">Indigo Carmine</a></li>  <li><a href="https://www.meghadyes.com/1-2-metal-complex-dyes-1768893.html">1:2 Metal Complex Dyes</a></li>  <li><a href="https://www.meghadyes.com/metal-complex-solvent-dyes-1599966.html">Metal Complex Solvent Dyes</a></li>  <li><a href="https://www.meghadyes.com/phthalogen-blue-if3gm-ingrain-blue-2-1-2664155.html">Phthalogen Blue If3gm - Ingrain Blue 2:1</a></li>  <li><a href="https://www.meghadyes.com/indigosol-vat-dyes-2664096.html">Indigosol Vat Dyes</a></li>  <li><a href="https://www.meghadyes.com/disperse-dyes-5056481.html">Disperse Dyes</a></li>  <li><a href="https://www.meghadyes.com/disperse-reactive-dyes-5059434.html">Disperse Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/oil-soluble-dyes-5059533.html">Oil soluble Dyes</a></li>  <li><a href="https://www.meghadyes.com/ph-indicators-5060204.html">PH Indicators</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/ultramarine-blue.html">Ultramarine Blue</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/masterbatch-additive-1768833.html">Masterbatch Additive</a></li>  <li><a href="https://www.meghadyes.com/pigment-inks--1768834.html">Pigment Inks </a></li>  <li><a href="https://www.meghadyes.com/ultramarine-blue-paint-pigments-1768835.html">Ultramarine Blue Paint Pigments</a></li>  <li><a href="https://www.meghadyes.com/ultramarine-for-surface-coating-1768837.html">Ultramarine for Surface Coating</a></li>  <li><a href="https://www.meghadyes.com/ultramarine-blue-for-rubber-1768839.html">Ultramarine Blue for Rubber</a></li>  <li><a href="https://www.meghadyes.com/ultramarine-blue-for-paper-industry-1768841.html">Ultramarine Blue For Paper Industry</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/dyestuffs.html">Dyestuffs</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/colorantes-dyes-6416372.html">Colorantes Dyes</a></li>  <li><a href="https://www.meghadyes.com/corantes-dyes-6416343.html">Corantes Dyes</a></li>  <li><a href="https://www.meghadyes.com/coloranti-dyes-6416385.html">Coloranti Dyes</a></li>  <li><a href="https://www.meghadyes.com/colorants-dyes-6416398.html">Colorants Dyes</a></li>  <li><a href="https://www.meghadyes.com/dyestuffs-1871230.html">Dyestuffs .</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/pigments.html">Pigments</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/textile-pigments-1599975.html">Textile Pigments</a></li>  <li><a href="https://www.meghadyes.com/pigment-powder-1637666.html">Pigment Powder</a></li>  <li><a href="https://www.meghadyes.com/organic-pigment-paste-1637669.html">Organic Pigment Paste</a></li>  <li><a href="https://www.meghadyes.com/chrome-pigment-5040243.html">Chrome Pigment</a></li>  <li><a href="https://www.meghadyes.com/black-pigment-5048656.html">Black Pigment</a></li>  <li><a href="https://www.meghadyes.com/blue-pigments-5040177.html">Blue Pigments</a></li>  <li><a href="https://www.meghadyes.com/pigment-emulsion-1768900.html">Pigment Emulsion</a></li>  <li><a href="https://www.meghadyes.com/food-pigment-5049313.html">Food Pigment</a></li>  <li><a href="https://www.meghadyes.com/chromium-pigments-5053241.html">Chromium Pigments</a></li>  <li><a href="https://www.meghadyes.com/organic-pigment-powder-5053242.html">Organic Pigment Powder</a></li>  <li><a href="https://www.meghadyes.com/fluorescent-pigments-5059999.html">Fluorescent Pigments</a></li>  <li><a href="https://www.meghadyes.com/pigments-dyes-5063360.html">Pigments Dyes</a></li>  <li><a href="https://www.meghadyes.com/inorganic-pigments-5063582.html">Inorganic Pigments</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/ph-stain-indicators.html">PH &amp; Stain Indicators</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/methyl-orange-1637703.html">Methyl Orange</a></li>  <li><a href="https://www.meghadyes.com/methyl-red-1637705.html">Methyl Red</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/food-colours.html">Food Colours</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/food-color-additives-1625935.html">Food Color Additives</a></li>  <li><a href="https://www.meghadyes.com/food-additives-5031781.html">Food Additives</a></li>  <li><a href="https://www.meghadyes.com/yellow-food-color-1634701.html">Yellow Food Color</a></li>  <li><a href="https://www.meghadyes.com/ponceau-4r-1634706.html">Ponceau 4R</a></li>  <li><a href="https://www.meghadyes.com/lake-colours-1610575.html">Lake Colours</a></li>  <li><a href="https://www.meghadyes.com/colours-for-seafood-industries-1768898.html">Colours for Seafood Industries</a></li>  <li><a href="https://www.meghadyes.com/brilliant-blue-1634744.html">Brilliant Blue</a></li>  <li><a href="https://www.meghadyes.com/food-dyes-5039724.html">Food Dyes</a></li>  <li><a href="https://www.meghadyes.com/quinoline-yellow-1637657.html">Quinoline Yellow</a></li>  <li><a href="https://www.meghadyes.com/patent-blue-v-1637653.html">Patent Blue V</a></li>  <li><a href="https://www.meghadyes.com/allura-red-1634731.html">Allura Red</a></li>  <li><a href="https://www.meghadyes.com/black-pn-1634771.html">Black PN</a></li>  <li><a href="https://www.meghadyes.com/natural-food-colour-1599971.html">Natural Food Colour</a></li>  <li><a href="https://www.meghadyes.com/carmoisine-1634703.html">Carmoisine .</a></li>  <li><a href="https://www.meghadyes.com/brown-ht-1637652.html">Brown HT</a></li>  <li><a href="https://www.meghadyes.com/tartrazine-food-color-1634696.html">Tartrazine Food Color</a></li>  <li><a href="https://www.meghadyes.com/food-colours-5221196.html">Food Colours</a></li>  <li><a href="https://www.meghadyes.com/natural-extracts-1768894.html">Natural Extracts</a></li>  <li><a href="https://www.meghadyes.com/red-2g-1634925.html">Red 2G</a></li>  <li><a href="https://www.meghadyes.com/-red-food-color--5032426.html">Red Food Color</a></li>  <li><a href="https://www.meghadyes.com/erythrosine-1634754.html">Erythrosine</a></li>  <li><a href="https://www.meghadyes.com/green-s-1637661.html">Green S</a></li>  <li><a href="https://www.meghadyes.com/amaranth-food-colours-1634708.html">Amaranth Food Colours</a></li>  <li><a href="https://www.meghadyes.com/blended-food-colors-5035442.html">Blended Food Colors</a></li>  <li><a href="https://www.meghadyes.com/food-color-dyes-5059568.html">Food Color Dyes</a></li>  <li><a href="https://www.meghadyes.com/primary-food-color-5063580.html">Primary Food Color</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/biological-stains.html">Biological Stains</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/basic-violet-5-dimethyl-safranine-1637684.html">Basic Violet 5 / Dimethyl Safranine</a></li>  <li><a href="https://www.meghadyes.com/titan-yellow-1637687.html">Titan Yellow</a></li>  <li><a href="https://www.meghadyes.com/trypan-blue-1637693.html">Trypan Blue</a></li>  <li><a href="https://www.meghadyes.com/methylene-blue-1637698.html">Methylene Blue</a></li>  <li><a href="https://www.meghadyes.com/janus-green-b-1637682.html">Janus Green B</a></li>  <li><a href="https://www.meghadyes.com/safranine-o-1637678.html">Safranine O</a></li>  <li><a href="https://www.meghadyes.com/orange-g-dyes-1637696.html">Orange G Dyes</a></li>  <li><a href="https://www.meghadyes.com/meldola-s-blue-1637691.html">Meldola s Blue</a></li>  <li><a href="https://www.meghadyes.com/diethyl-safranine-1637680.html">Diethyl Safranine</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/dye-intermediates.html">Dye Intermediates</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/dyes-intermediate-1637722.html">Dyes Intermediate</a></li>  <li><a href="https://www.meghadyes.com/reactive-dye-intermediates-5040100.html">Reactive Dye Intermediates</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/optical-whitening-agent.html">Optical Whitening Agent</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/optical-whitening-agent-1765455.html">Optical Whitening Agent</a></li>  <li><a href="https://www.meghadyes.com/optical-brighteners-1599972.html">Optical Brighteners</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/fine-chemical.html">Fine Chemical</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/patent-blue-5063590.html">Patent Blue</a></li>  <li><a href="https://www.meghadyes.com/lake-colour-5031725.html">Lake Colour</a></li>  <li><a href="https://www.meghadyes.com/orange-flavor-5031800.html">Orange Flavour</a></li>  <li><a href="https://www.meghadyes.com/crystal-violet-5039905.html">Crystal Violet</a></li>  <li><a href="https://www.meghadyes.com/solvent-red-5040103.html">Solvent Red</a></li>  <li><a href="https://www.meghadyes.com/textile-dyes-5040150.html">Textile Dyes</a></li>  <li><a href="https://www.meghadyes.com/printing-inks-pigment-5040209.html">Printing Inks Pigment</a></li>  <li><a href="https://www.meghadyes.com/pigment-red-5040233.html">Pigment Red</a></li>  <li><a href="https://www.meghadyes.com/colour-pigments-5048567.html">Colour Pigments</a></li>  <li><a href="https://www.meghadyes.com/frp-pigment-5048570.html">FRP Pigment</a></li>  <li><a href="https://www.meghadyes.com/rubber-pigments-5048571.html">Rubber Pigments</a></li>  <li><a href="https://www.meghadyes.com/organic-pigments-5048574.html">Organic Pigments</a></li>  <li><a href="https://www.meghadyes.com/plastic-pigments-5048575.html">Plastic Pigments</a></li>  <li><a href="https://www.meghadyes.com/golden-brown-pigment-5048581.html">Golden Brown Pigment</a></li>  <li><a href="https://www.meghadyes.com/alpha-blue-pigments-5048597.html">Alpha Blue Pigments</a></li>  <li><a href="https://www.meghadyes.com/pigment-emulsions-5048598.html">Pigment Emulsions</a></li>  <li><a href="https://www.meghadyes.com/ultramarine-pigment-5048605.html">Ultramarine Pigment</a></li>  <li><a href="https://www.meghadyes.com/brown-pigment-paste-5048611.html">Brown Pigment Paste</a></li>  <li><a href="https://www.meghadyes.com/phthalocyanine-blue-5048618.html">Phthalocyanine Blue</a></li>  <li><a href="https://www.meghadyes.com/carbon-black-pigment-5048648.html">Carbon Black Pigment</a></li>  <li><a href="https://www.meghadyes.com/pigment-beta-blue-5049172.html">Pigment Beta Blue</a></li>  <li><a href="https://www.meghadyes.com/paint-pigment-5049188.html">Paint Pigment</a></li>  <li><a href="https://www.meghadyes.com/iron-oxide-pigment-5049210.html">Iron Oxide Pigment</a></li>  <li><a href="https://www.meghadyes.com/dispersion-pigment-5049218.html">Dispersion Pigment</a></li>  <li><a href="https://www.meghadyes.com/rubine-toner-5049222.html">Rubine Toner</a></li>  <li><a href="https://www.meghadyes.com/lake-pigments-5049223.html">Lake Pigments</a></li>  <li><a href="https://www.meghadyes.com/copper-phthalocyanine-pigment-5049247.html">Copper Phthalocyanine Pigment</a></li>  <li><a href="https://www.meghadyes.com/sunset-yellow-fcf-5049249.html">Sunset Yellow FCF</a></li>  <li><a href="https://www.meghadyes.com/blue-pigment-paste-5049253.html">Blue Pigment Paste</a></li>  <li><a href="https://www.meghadyes.com/pigment-orange-5049282.html">Pigment Orange</a></li>  <li><a href="https://www.meghadyes.com/color-pigment-5049310.html">Color Pigment</a></li>  <li><a href="https://www.meghadyes.com/blue-pigment-5049315.html">Blue Pigment</a></li>  <li><a href="https://www.meghadyes.com/pigment-ink-5049318.html">Pigment Ink</a></li>  <li><a href="https://www.meghadyes.com/violet-pigment-5049323.html">Violet Pigment</a></li>  <li><a href="https://www.meghadyes.com/phthalocyanine-pigment-5049327.html">Phthalocyanine Pigment</a></li>  <li><a href="https://www.meghadyes.com/dye-chemicals-5039913.html">Dye Chemicals</a></li>  <li><a href="https://www.meghadyes.com/natural-pigment-5053238.html">Natural Pigment</a></li>  <li><a href="https://www.meghadyes.com/ink-dyes-5055015.html">Ink Dyes</a></li>  <li><a href="https://www.meghadyes.com/cold-dyes-5055560.html">Cold Dyes</a></li>  <li><a href="https://www.meghadyes.com/thermochromic-dyes-5055598.html">Thermochromic Dyes</a></li>  <li><a href="https://www.meghadyes.com/water-dyes-5055613.html">Water Dyes</a></li>  <li><a href="https://www.meghadyes.com/petroleum-dyes-5055720.html">Petroleum Dyes</a></li>  <li><a href="https://www.meghadyes.com/sulphur-black-dyes-5055803.html">Sulphur Black Dyes</a></li>  <li><a href="https://www.meghadyes.com/synthetic-dyes-5055815.html">Synthetic Dyes</a></li>  <li><a href="https://www.meghadyes.com/nylon-dyes-5055830.html">Nylon Dyes</a></li>  <li><a href="https://www.meghadyes.com/rapid-dyes-5055837.html">Rapid Dyes</a></li>  <li><a href="https://www.meghadyes.com/metal-dyes-5055867.html">Metal Dyes</a></li>  <li><a href="https://www.meghadyes.com/chrome-dyes-5055880.html">Chrome Dyes</a></li>  <li><a href="https://www.meghadyes.com/polyester-dyes-5055884.html">Polyester Dyes</a></li>  <li><a href="https://www.meghadyes.com/soap-dyes-5055906.html">Soap Dyes</a></li>  <li><a href="https://www.meghadyes.com/wate-dyes-5055918.html">Wate Dyes</a></li>  <li><a href="https://www.meghadyes.com/azo-dyes-5055943.html">AZO Dyes</a></li>  <li><a href="https://www.meghadyes.com/clothing-dye-5055949.html">Clothing Dye</a></li>  <li><a href="https://www.meghadyes.com/synthetic-organic-dyes-5055960.html">Synthetic Organic Dyes</a></li>  <li><a href="https://www.meghadyes.com/rubber-dyes-5056159.html">Rubber Dyes</a></li>  <li><a href="https://www.meghadyes.com/yellow-dyes-5056167.html">Yellow Dyes</a></li>  <li><a href="https://www.meghadyes.com/direct-liquid-dyes-5056193.html">Direct Liquid Dyes</a></li>  <li><a href="https://www.meghadyes.com/liquid-acrylic-dyes-5056195.html">Liquid Acrylic Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-red-dyes-5056372.html">Reactive Red Dyes</a></li>  <li><a href="https://www.meghadyes.com/plastic-dyes-5056377.html">Plastic Dyes</a></li>  <li><a href="https://www.meghadyes.com/violet-dyes-5056380.html">Violet Dyes</a></li>  <li><a href="https://www.meghadyes.com/sunfast-direct-dyes-5056383.html">Sunfast Direct Dyes</a></li>  <li><a href="https://www.meghadyes.com/remazol-dyes-5056397.html">Remazol Dyes</a></li>  <li><a href="https://www.meghadyes.com/candle-dyes-5056412.html">Candle Dyes</a></li>  <li><a href="https://www.meghadyes.com/powdered-dyes-5056415.html">Powdered Dyes</a></li>  <li><a href="https://www.meghadyes.com/wax-printing-dyes-5056436.html">Wax Printing Dyes</a></li>  <li><a href="https://www.meghadyes.com/basic-vat-dyes-5056448.html">Basic Vat Dyes</a></li>  <li><a href="https://www.meghadyes.com/cold-brand-dyes-5056454.html">Cold Brand Dyes</a></li>  <li><a href="https://www.meghadyes.com/direct-blue-dyes-5056459.html">Direct Blue Dyes</a></li>  <li><a href="https://www.meghadyes.com/wood-dyes-5056462.html">Wood Dyes</a></li>  <li><a href="https://www.meghadyes.com/soluble-dyes-5056465.html">Soluble Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-brown-dyes-5056478.html">Acid Brown Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-green-dyes-5056479.html">Acid Green Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-blue-dye-5056484.html">Reactive Blue Dye</a></li>  <li><a href="https://www.meghadyes.com/sulphur-dyes-5056495.html">Sulphur Dyes</a></li>  <li><a href="https://www.meghadyes.com/plastic-coloring-dyes-5059159.html">Plastic Coloring Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-violet-dyes-5059170.html">Acid Violet Dyes</a></li>  <li><a href="https://www.meghadyes.com/blue-dyes-5059194.html">Blue Dyes</a></li>  <li><a href="https://www.meghadyes.com/moulded-dyes-5059208.html">Moulded Dyes</a></li>  <li><a href="https://www.meghadyes.com/natural-blue-dyes-5059419.html">Natural Blue Dyes</a></li>  <li><a href="https://www.meghadyes.com/acid-black-dyes-5059443.html">Acid Black Dyes</a></li>  <li><a href="https://www.meghadyes.com/vat-dyes-5059450.html">Vat Dyes</a></li>  <li><a href="https://www.meghadyes.com/metal-complex-dyes-5059452.html">Metal Complex Dyes</a></li>  <li><a href="https://www.meghadyes.com/organic-chemical-dyes-5059461.html">Organic Chemical Dyes</a></li>  <li><a href="https://www.meghadyes.com/hot-brand-reactive-dyes-5059475.html">Hot Brand Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/direct-yellow-dyes-5059577.html">Direct Yellow Dyes</a></li>  <li><a href="https://www.meghadyes.com/garment-dyes-5059621.html">Garment Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-cold-dyes-5059649.html">Reactive Cold Dyes</a></li>  <li><a href="https://www.meghadyes.com/auramine-dyes-5059651.html">Auramine Dyes</a></li>  <li><a href="https://www.meghadyes.com/printing-dyes-5059661.html">Printing Dyes</a></li>  <li><a href="https://www.meghadyes.com/cotton-dyes-5059668.html">Cotton Dyes</a></li>  <li><a href="https://www.meghadyes.com/indigo-dyes-5059692.html">Indigo Dyes</a></li>  <li><a href="https://www.meghadyes.com/natural-textile-dyes-5059695.html">Natural Textile Dyes</a></li>  <li><a href="https://www.meghadyes.com/rapid-fast-dyes-5059741.html">Rapid Fast Dyes</a></li>  <li><a href="https://www.meghadyes.com/methyl-violet-dyes-5059754.html">Methyl Violet Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-m-dyes-5059765.html">Reactive M Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-h-dyes-5059782.html">Reactive H Dyes</a></li>  <li><a href="https://www.meghadyes.com/vinyl-sulphone-reactive-dyes-5059794.html">Vinyl Sulphone Reactive Dyes</a></li>  <li><a href="https://www.meghadyes.com/turquoise-blue-dyes-5059833.html">Turquoise Blue Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-yellow-dyes--5059841.html">Reactive Yellow Dyes,</a></li>  <li><a href="https://www.meghadyes.com/reactive-black-dyes-5059876.html">Reactive Black Dyes</a></li>  <li><a href="https://www.meghadyes.com/rhodamine-dyes-5059896.html">Rhodamine Dyes</a></li>  <li><a href="https://www.meghadyes.com/reactive-orange-dyes-5059909.html">Reactive Orange Dyes</a></li>  <li><a href="https://www.meghadyes.com/phenol-red-5059942.html">Phenol Red</a></li>  <li><a href="https://www.meghadyes.com/reactive-blue-dyestuff-5059967.html">Reactive Blue Dyestuff</a></li>  <li><a href="https://www.meghadyes.com/sulphur-black-5060011.html">Sulphur Black</a></li>  <li><a href="https://www.meghadyes.com/fast-scarlet-g-base-5060045.html">Fast Scarlet G Base</a></li>  <li><a href="https://www.meghadyes.com/synthetic-dyestuff-5060050.html">Synthetic Dyestuff</a></li>  <li><a href="https://www.meghadyes.com/smoke-dyes-5060065.html">Smoke Dyes</a></li>  <li><a href="https://www.meghadyes.com/cationic-dyestuff-5060100.html">Cationic Dyestuff</a></li>  <li><a href="https://www.meghadyes.com/ultramarine-blue-5060748.html">Ultramarine Blue</a></li>  <li><a href="https://www.meghadyes.com/amaranth-5063230.html">Amaranth</a></li>  <li><a href="https://www.meghadyes.com/lake-erythrosine-5063235.html">Lake Erythrosine</a></li>  <li><a href="https://www.meghadyes.com/safranin-5063374.html">Safranin</a></li>  <li><a href="https://www.meghadyes.com/basic-violet-5063405.html">Basic Violet</a></li>  <li><a href="https://www.meghadyes.com/basic-orange-5063438.html">Basic Orange</a></li>  <li><a href="https://www.meghadyes.com/masterbatch-5063449.html">Masterbatch</a></li>  <li><a href="https://www.meghadyes.com/phenylenediamine-5063451.html">Phenylenediamine</a></li>  <li><a href="https://www.meghadyes.com/vinyl-sulphone-5063523.html">Vinyl Sulphone</a></li>  <li><a href="https://www.meghadyes.com/optical-brightening-agents-5063574.html">Optical Brightening Agents</a></li>  <li><a href="https://www.meghadyes.com/guar-gum-powder-5063575.html">Guar Gum Powder</a></li>  <li><a href="https://www.meghadyes.com/cobalt-5063577.html">Cobalt</a></li>  <li><a href="https://www.meghadyes.com/colorants-5063578.html">Colorants</a></li>  <li><a href="https://www.meghadyes.com/vinyl-sulfone-dyes-5063579.html">Vinyl Sulfone Dyes</a></li>  <li><a href="https://www.meghadyes.com/red-oxide-pigments-5063589.html">Red Oxide Pigments</a></li>  <li><a href="https://www.meghadyes.com/violet-pigment-paste-5065027.html">Violet Pigment Paste</a></li>  <li><a href="https://www.meghadyes.com/pigment-rubine-5065044.html">Pigment Rubine</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/biological-reagents.html">Biological Reagents</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/stain-and-indicators-1599973.html">Stain and Indicators</a></li>  <li><a href="https://www.meghadyes.com/biological-stains-5060197.html">Biological Stains</a></li>  </ul></li>  <li class="has-sub"><span class="submenu-button"></span><a href="/paper-dyes-5221209.html">Paper Dyes</a>  <ul id="myDiv">  <li><a href="https://www.meghadyes.com/paper-dyes-5221209.html">Paper Dyes</a></li>  </ul></li></ul>';
	sope = BeautifulSoup(htmlStr,  "html.parser", from_encoding="utf-8").find("ul")

	ps = sope.find_all("li", recursive=False)
	for p in ps:
		pLink = p.find("a")
		if pLink != None:
			type1 = getNodeText(pLink)
			type2s = p.find_all("li")
			for type2 in type2s:
				pLink = type2.find("a")
				type2Str = getNodeText(pLink);
				# print(type1+"==="+type2Str)
				getProductInfo(pLink["href"], type1, type2Str)
			

headers=['link', 'Product type1','Product type2','Product type3','Product Description','Application','features']

getProductList('','')
# getProductInfo("https://www.meghadyes.com/industrial-reactive-dyes-1634617.html", "", "")
# getProductInfo("https://www.meghadyes.com/direct-reactive-dye-1634646.html", "", "")

# getProductInfo("https://www.meghadyes.com/reactive-yellow-44-3130024.html", "", "")

# getProductInfo("https://www.meghadyes.com/highly-exhausted-reactive-dyes-6952209.html", "", "")



excelUtils.generateExcelMultipleSheet('meghadyes.xlsx', [
	{
		"name":"meghadyes",
		"header": headers ,
		"data": products1
	},{
		"name":"PRODUCTS",
		"header": ['Product type1','Product type2','Product type3','PRODUCTS','C. I. NAME','CAS NO.'] ,
		"data": products2
	}
])