from urllib.request import urlopen
import urllib
from selenium import webdriver
from bs4 import BeautifulSoup
import http.client
from openpyxl import Workbook
from openpyxl import load_workbook
from openpyxl.writer.excel import ExcelWriter
from openpyxl.cell.cell import ILLEGAL_CHARACTERS_RE
import json
import re
import copy
import string

http.client._MAXHEADERS = 1000

def urllib_download(IMAGE_URL, pName):
	try:
		opener = urllib.request.build_opener()
		opener.addheaders = [('User-agent', 'Mozilla/5.0')]
		urllib.request.install_opener(opener)
		urllib.request.urlretrieve(IMAGE_URL, pName.replace("/","").replace("\\","")+'.jpg')
	except:
		print('no')

def getNodeText(node):
	if(node == None):
		return ""
	else:
		return node.get_text().strip()

retryCount = 0
loadCount = 0
def getHtmlFromUrl(url, type="get", para={}):
	global retryCount
	try:
		url = urllib.parse.quote(url, safe=string.printable).replace(' ','%20')
		headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36"}

		request_obj=urllib.request.Request(url=url)
		response_obj=urllib.request.urlopen(request_obj)
		html_code=response_obj.read()
		return html_code
	except:
		print("retry"+url)
		retryCount += 1
		print(retryCount)
		if retryCount < 5:
			getHtmlFromUrl(url)
def getRenderdHtmlFromUrl(url):
	chrome_options = webdriver.ChromeOptions()
	chrome_options.add_argument('--headless')
	chrome_options.add_argument('--disable-gpu')
	chrome_options.add_argument("window-size=1024,768")

	chrome_options.add_argument("--no-sandbox")
	browser = webdriver.Chrome(chrome_options=chrome_options)
	
	browser.get(url)
	return browser.page_source
	
def writeExcel(workSheet, headers, rowIndex, info):
	cellIndex=1
	for head in headers:
		try:
			if head in info:
				content = ILLEGAL_CHARACTERS_RE.sub(r'', info[head])
				workSheet.cell(rowIndex, cellIndex).value = content.strip()
			else:
				workSheet.cell(rowIndex, cellIndex).value = ""
			cellIndex=cellIndex+1
		except:
			print(rowIndex)


def getProductInfo(url, cas, products):
	print(str(len(products))+ cas + url)
	
	productListHtml = getHtmlFromUrl(url)
	tempPinfo = {"cas":cas}
	data = json.loads(productListHtml)
		
	Section = data["Record"]["Section"]
	TOCHeading1 = next(filter(lambda i: i["TOCHeading"]=="Names and Identifiers", Section))
	TOCHeading1Section = TOCHeading1["Section"]
	TOCHeading2 = next(filter(lambda i : i["TOCHeading"]=="Computed Descriptors", TOCHeading1Section))
	TOCHeading2Section = TOCHeading2["Section"]
	
	InChI = next(filter(lambda i: i["TOCHeading"]=="InChI", TOCHeading2Section))
	InChIKey = next(filter(lambda i : i["TOCHeading"]=="InChI Key", TOCHeading2Section))
	
	tempPinfo["InChI"] = InChI["Information"][0]["Value"]["StringWithMarkup"][0]["String"]
	tempPinfo["InChIKey"] = InChIKey["Information"][0]["Value"]["StringWithMarkup"][0]["String"]
	products.append(tempPinfo.copy())

def getProductList(cas, products):
	productListHtml = getHtmlFromUrl("https://pubchem.ncbi.nlm.nih.gov/sdq/sdqagent.cgi?infmt=json&outfmt=json&query={%22select%22:%22*%22,%22collection%22:%22compound%22,%22where%22:{%22ands%22:[{%22*%22:%22"+cas+"%22}]},%22order%22:[%22relevancescore,desc%22],%22start%22:1,%22limit%22:10,%22width%22:1000000,%22listids%22:0}")
	if productListHtml!=None:
		data = json.loads(productListHtml)
		if len(data["SDQOutputSet"][0]["rows"]) >0:
			cid = data["SDQOutputSet"][0]["rows"][0]["cid"]
			try:
				getProductInfo("https://pubchem.ncbi.nlm.nih.gov/rest/pug_view/data/compound/"+str(cid)+"/JSON/",cas, products)
			except:
				products.append({"cas":cas, cid: cid})
	else:
		products.append({"cas":cas})

excelFileName="pubchem.xlsx"
wb = Workbook()
workSheet = wb.active
products = []
cass = [
'100-06-1',
'100-07-2',
'100125-12-0',
'10022-68-1',
'10024-89-2',
'10025-73-7',
'10025-74-8',
'10025-75-9',
'10025-76-0',
'10025-82-8',
'10025-83-9',
'10025-84-0',
'10025-99-7',
'10026-18-3',
'10026-24-1',
'100-26-5',
'10031-22-8',
'10031-51-3',
'10031-82-0',
'10042-88-3',
'100516-62-9',
'100669-96-3',
'100-97-0',
'10099-58-8',
'1010-19-1',
'101023-55-6',
'101023-58-9',
'10102-68-8',
'101066-87-9',
'101-16-6',
'10125-13-0',
'1013027-27-4',
'1013405-24-7',
'10138-41-7',
'10138-52-0',
'10138-62-2',
'101-53-1',
'10170-68-0',
'1017794-47-6',
'10199-00-5',
'1019983-99-3',
'10202-45-6',
'102-24-9',
'1025451-57-3',
'102601-60-5',
'10294-46-9',
'10294-50-5',
'10294-54-9',
'103068-20-8',
'10311-61-2',
'10312-55-7',
'1033035-83-4',
'1034343-98-0',
'10355-53-0',
'1035631-57-2',
'10361-37-2',
'1036248-62-0',
'10368-73-7',
'10377-51-2',
'10377-52-3',
'1040352-82-6',
'104-13-2',
'1042093-98-0',
'1043023-52-4',
'104-42-7',
'1044795-04-1',
'10450-59-6',
'104515-79-9',
'1046099-39-1',
'1047-16-1',
'1047684-56-9',
'10484-13-6',
'1048679-01-1',
'104-87-0',
'104-92-7',
'104934-50-1',
'104-94-9',
'105029-70-7',
'105125-00-6',
'10517-44-9',
'105309-59-9',
'10534-89-1',
'105365-51-3',
'105389-36-4',
'10541-56-7',
'1055-23-8',
'10553-31-8',
'105-58-8',
'105640-07-1',
'1057745-51-3',
'105890-71-9',
'1059624-23-5',
'10602-00-3',
'106294-60-4',
'106344-20-1',
'106349-49-9',
'106-38-7',
'106-40-1',
'106-41-2',
'106418-67-1',
'106495-57-2',
'106-51-4',
'1067877-96-6',
'106920-29-0',
'1071224-34-4',
'1072413-80-9',
'1072413-89-8',
'1072-53-3',
'1073183-32-0',
'1076-97-7',
'1079129-48-8',
'1081-34-1',
'108228-37-1',
'108-32-7',
'108-90-7',
'1090-13-7',
'109073-77-0',
'1092356-36-9',
'1092578-51-2',
'109306-86-7',
'1093859-61-0',
'109-77-3',
'109781-47-7',
'109-78-4',
'1098102-95-4',
'109-86-4',
'1100243-40-0',
'110314-07-3',
'110453-78-6',
'110-61-2',
'110-67-8',
'11078-74-3',
'110851-65-5',
'1109-15-5',
'1111-67-7',
'111-42-2',
'1115639-92-3',
'1116499-73-0',
'111-69-3',
'111928-21-3',
'112-04-9',
'1120-71-4',
'112078-08-7',
'1121-03-5',
'1122-28-7',
'112-24-3',
'1122-91-4',
'112400-86-9',
'1124-64-7',
'112-60-7',
'112642-69-0',
'112-80-1',
'1128045-14-6',
'112-88-9',
'1134-35-6',
'113682-56-7',
'113703-66-5',
'113728-71-5',
'1138220-69-5',
'114395-69-6',
'114435-02-8',
'114482-57-4',
'1147124-21-7',
'1148-79-4',
'115383-22-7',
'1158227-56-5',
'115-86-6',
'115-96-8',
'1160106-14-8',
'116020-44-1',
'1160823-76-6',
'1160823-77-7',
'116469-02-4',
'1165-53-3',
'116903-46-9',
'116903-49-2',
'116941-51-6',
'116941-52-7',
'117029-34-2',
'1171974-28-9',
'1174006-47-3',
'1174223-25-6',
'117901-97-0',
'117923-32-7',
'117943-37-0',
'1179993-72-6',
'118129-60-5',
'118164-50-4',
'118164-51-5',
'1184-10-7',
'1185885-86-2',
'118599-27-2',
'1186103-43-4',
'118688-53-2',
'118727-34-7',
'118-75-2',
'118951-68-1',
'118996-38-6',
'119171-18-5',
'119229-99-1',
'1192352-08-1',
'1192352-10-5',
'119301-59-6',
'1194-02-1',
'119586-44-6',
'1198395-24-2',
'119990-81-7',
'1200-14-2',
'12003-65-5',
'120141-26-6',
'12014-56-1',
'1201561-34-3',
'1201915-91-4',
'12027-06-4',
'12030-24-9',
'120305-22-8',
'12031-75-3',
'12033-89-5',
'12036-44-1',
'12037-01-3',
'12037-29-5',
'120389-54-0',
'12054-85-2',
'12055-62-8',
'12060-58-1',
'12060-59-2',
'12061-16-4',
'12063-98-8',
'1206544-88-8',
'1207176-84-8',
'1207461-57-1',
'1207638-53-6',
'12081-88-8',
'12086-40-7',
'121040-08-2',
'121219-08-7',
'12125-01-8',
'12125-02-9',
'12137-20-1',
'121-43-7',
'121554-18-5',
'121-91-5',
'1219956-30-5',
'122-00-9',
'12201-18-2',
'12228-87-4',
'1223559-98-5',
'122413-85-8',
'12253-68-8',
'12260-45-6',
'122648-99-1',
'122738-21-0',
'1228047-99-1',
'1228778-59-3',
'12289-94-0',
'1231160-83-0',
'123273-09-6',
'123-30-8',
'1233200-57-1',
'1235234-32-8',
'1235234-35-1',
'1235234-47-5',
'123-54-6',
'123560-48-5',
'1236349-67-9',
'123640-38-0',
'12370-59-1',
'1237479-38-7',
'123843-69-6',
'123847-85-8',
'1239602-35-7',
'1240372-42-2',
'1240557-01-0',
'1241-94-7',
'1242056-42-3',
'124-42-5',
'1245-13-2',
'1245570-04-0',
'1246467-58-2',
'124729-02-8',
'124729-98-2',
'125143-53-5',
'1251503-35-1',
'1254062-41-3',
'125565-45-9',
'125652-55-3',
'1257379-83-1',
'1258419-69-0',
'1258780-50-5',
'125962-80-3',
'1260119-00-3',
'1262230-03-4',
'126-33-0',
'1263-63-4',
'1269669-42-2',
'1269669-43-3',
'1271439-08-7',
'1274904-48-1',
'128-56-3',
'128-63-2',
'128-69-8',
'128-97-2',
'129135-86-0',
'129135-87-1',
'1293389-28-2',
'129738-34-7',
'129738-42-7',
'13036-19-6',
'1304-76-3',
'13053-75-3',
'1305-78-8',
'1306-19-0',
'1306-23-6',
'1306-25-8',
'1306-38-3',
'1308-96-9',
'1309-60-0',
'1309-64-4',
'1309760-94-8',
'1310-66-3',
'131159-39-2',
'1312310-16-9',
'1312-43-2',
'1312-81-8',
'1313-13-9',
'1313514-53-2',
'1313-82-2',
'1313876-00-4',
'1313-99-1',
'1314-13-2',
'1314-36-9',
'1314-37-0',
'1314-62-1',
'1314-96-1',
'1314-98-3',
'1315-09-9',
'1315-11-3',
'131651-65-5',
'1317-34-6',
'1317-35-7',
'1317-40-4',
'131790-57-3',
'131819-23-3',
'131819-24-4',
'1320201-22-6',
'132034-89-0',
'132123-39-8',
'132123-45-6',
'132-16-1',
'132361-22-9',
'132396-99-7',
'132-65-0',
'13275-42-8',
'132765-35-6',
'132765-36-7',
'132814-92-7',
'132843-44-8',
'1328-53-6',
'13292-05-2',
'1330-20-7',
'1330-78-5',
'133113-76-5',
'13311-45-0',
'1331742-86-9',
'1331756-62-7',
'13329-40-3',
'133314-07-5',
'1333-82-0',
'133395-16-1',
'1334407-47-4',
'133546-47-1',
'133546-50-6',
'13362-78-2',
'133676-09-2',
'1338446-77-7',
'13388-33-5',
'133937-72-1',
'13395-16-9',
'13400-13-0',
'134008-76-7',
'1341-49-7',
'134-32-7',
'134412-17-2',
'134412-18-3',
'1344-43-0',
'13450-87-8',
'13450-88-9',
'13450-90-3',
'13450-91-4',
'13450-92-5',
'13450-95-8',
'13453-69-5',
'13453-80-0',
'13454-84-7',
'1345614-94-9',
'1346007-05-3',
'13464-82-9',
'13465-10-6',
'1347736-74-6',
'13478-06-3',
'13478-10-9',
'13478-33-6',
'134984-37-5',
'13510-35-5',
'135113-15-4',
'135113-16-5',
'1351279-73-6',
'1351870-16-0',
'1351986-34-9',
'1352642-37-5',
'1354749-13-5',
'135-48-8',
'13569-80-7',
'135704-54-0',
'13573-08-5',
'135734-59-7',
'135822-72-9',
'1359740-26-3',
'136316-32-0',
'13638-82-9',
'136609-96-6',
'13674-87-8',
'13688-68-1',
'137019-95-5',
'13718-50-8',
'1373116-00-7',
'13731-82-3',
'1373334-05-4',
'1373934-14-5',
'13746-66-2',
'137529-41-0',
'137529-43-2',
'13755-29-8',
'13759-92-7',
'13760-80-0',
'137644-54-3',
'13765-25-8',
'13765-26-9',
'13780-42-2',
'13781-37-8',
'13798-24-8',
'13799-90-1',
'13813-22-4',
'138171-14-9',
'138184-36-8',
'13820-41-2',
'13820-46-7',
'13826-83-0',
'13826-86-3',
'13826-94-3',
'1382955-10-3',
'138372-67-5',
'1384281-49-5',
'13862-78-7',
'13877-16-2',
'139092-78-7',
'139215-80-8',
'1392416-39-5',
'1394221-73-8',
'1395881-55-6',
'1395881-58-9',
'1397202-77-5',
'1397288-30-0',
'1398395-83-9',
'139994-47-1',
'14014-88-1',
'1401708-91-5',
'14024-63-6',
'14024-64-7',
'1404201-64-4',
'14074-80-7',
'14118-16-2',
'1412448-63-5',
'1413269-55-2',
'141-43-5',
'141460-19-7',
'14154-42-8',
'1415929-80-4',
'1416330-84-1',
'14172-90-8',
'14172-92-0',
'141752-82-1',
'141-82-2',
'14187-14-5',
'141981-64-8',
'142137-17-5',
'1421599-34-9',
'14222-98-1',
'142289-08-5',
'14235-81-5',
'142400-92-8',
'142-45-0',
'142593-07-5',
'1426332-00-4',
'142-64-3',
'142646-58-0',
'142-65-4',
'142807-63-4',
'142894-38-0',
'142-95-0',
'14320-04-8',
'14325-05-4',
'143314-14-1',
'143314-16-3',
'14348-75-5',
'14354-67-7',
'143874-13-9',
'143886-11-7',
'1443049-83-9',
'1443049-84-0',
'1443049-85-1',
'14457-87-5',
'14483-18-2',
'14488-45-0',
'14494-37-2',
'144981-85-1',
'145022-44-2',
'1450-63-1',
'14507-19-8',
'1451075-54-9',
'1451592-07-6',
'1452099-14-7',
'145240-28-4',
'14544-47-9',
'1455-18-1',
'1458041-70-7',
'145898-89-1',
'146368-11-8',
'146368-13-0',
'146368-16-3',
'1467776-41-5',
'14689-45-3',
'14691-88-4',
'14691-89-5',
'1469791-66-9',
'147045-24-7',
'147-14-8',
'147622-85-3',
'1477458-14-2',
'147859-70-9',
'1478-61-1',
'147-93-3',
'147951-02-8',
'147951-36-8',
'148044-07-9',
'148332-36-9',
'1484-13-5',
'1486-51-7',
'14866-33-2',
'1487-82-7',
'148819-81-2',
'149104-90-5',
'1491133-64-2',
'14913-14-5',
'14914-84-2',
'14916-87-1',
'14923-84-3',
'14937-45-2',
'14938-35-3',
'14938-42-2',
'14945-24-5',
'14949-69-0',
'14977-61-8',
'149817-62-9',
'14984-76-0',
'1498-96-0',
'1499-10-1',
'14996-61-3',
'150-46-9',
'15051-46-4',
'15060-55-6',
'15066-80-5',
'150763-46-5',
'150-76-5',
'150805-46-2',
'15082-28-7',
'151059-43-7',
'1513-87-7',
'151391-00-3',
'151417-38-8',
'15155-41-6',
'151575-30-3',
'15164-44-0',
'15170-57-7',
'1518-16-7',
'15187-16-3',
'15238-00-3',
'15243-48-8',
'15244-10-7',
'15244-35-6',
'15244-38-9',
'15293-74-0',
'153035-55-3',
'15304-57-1',
'153429-47-1',
'153467-50-6',
'153561-79-6',
'1537175-69-1',
'15383-49-0',
'154102-21-3',
'1541200-53-6',
'15442-64-5',
'15469-38-2',
'155041-85-3',
'1551-39-9',
'155266-68-5',
'155306-71-1',
'155371-19-0',
'15546-43-7',
'15567-09-6',
'15570-45-3',
'15572-56-2',
'15599-91-4',
'156244-98-3',
'156-28-5',
'1562-94-3',
'1563062-80-5',
'156-43-4',
'156487-12-6',
'15651-37-3',
'15802-00-3',
'1583-67-1',
'1585-40-6',
'15862-18-7',
'15878-77-0',
'158871-28-4',
'1591-31-7',
'159191-56-7',
'159-66-0',
'159-68-2',
'160096-76-4',
'160542-02-9',
'1606-67-3',
'160780-82-5',
'160848-22-6',
'1609131-78-3',
'1609536-17-5',
'1612793-07-3',
'161485-60-5',
'16152-10-6',
'1622008-73-4',
'162258-89-1',
'1623-19-4',
'16245-79-7',
'1628-29-1',
'16292-17-4',
'162967-90-0',
'1630723-98-6',
'1633-14-3',
'16331-46-7',
'1633-83-6',
'163584-80-3',
'1638-22-8',
'16385-59-4',
'16433-88-8',
'1643842-69-6',
'1644164-62-4',
'1644381-95-2',
'16450-38-7',
'16456-81-8',
'164724-35-0',
'165190-76-1',
'165320-27-4',
'165324-09-4',
'1656-48-0',
'165900-07-2',
'1661-03-6',
'1662-01-7',
'1666-13-3',
'16712-64-4',
'1671-87-0',
'167218-46-4',
'16774-21-3',
'1679-18-1',
'1681007-44-2',
'168106-22-7',
'168106-25-0',
'168127-49-9',
'16829-91-7',
'16833-17-3',
'16834-13-2',
'16881-71-3',
'1689538-58-6',
'169051-76-7',
'16919-19-0',
'16920-93-7',
'16921-30-5',
'16940-92-4',
'16941-06-3',
'16941-11-0',
'16941-14-3',
'16962-40-6',
'169685-34-1',
'1701403-91-9',
'170165-81-8',
'1702-42-7',
'17051-01-3',
'1705581-28-7',
'17084-13-8',
'1711-02-0',
'1714-29-0',
'171611-11-3',
'17194-00-2',
'17217-57-1',
'17224-17-8',
'17224-18-9',
'172285-72-2',
'1724-08-9',
'17252-51-6',
'172616-80-7',
'172617-46-8',
'1732-26-9',
'1738-36-9',
'173837-35-9',
'17392-83-5',
'174063-87-7',
'17419-81-7',
'174350-05-1',
'174350-08-4',
'174501-64-5',
'174501-65-6',
'174899-65-1',
'174899-66-2',
'174899-81-1',
'174899-82-2',
'174899-83-3',
'174899-86-6',
'174899-90-2',
'174899-94-6',
'17524-05-9',
'17573-94-3',
'1762-34-1',
'1762-42-1',
'1762-84-1',
'17632-18-7',
'1767-46-0',
'17696-60-5',
'1772-25-4',
'177586-41-3',
'17768-28-4',
'177716-59-5',
'177799-16-5',
'17788-94-2',
'177991-01-4',
'17856-92-7',
'178631-04-4',
'17866-84-1',
'179075-88-8',
'1801701-58-5',
'1802013-84-8',
'1802-30-8',
'1804970-28-2',
'1807536-06-6',
'1813-60-1',
'18146-62-8',
'1821033-48-0',
'1821433-54-8',
'182507-83-1',
'18253-54-8',
'182918-13-4',
'1835-65-0',
'18361-03-0',
'18390-00-6',
'18511-69-8',
'18511-71-2',
'1855846-73-9',
'185626-73-7',
'185690-41-9',
'186088-50-6',
'186497-67-6',
'18733-91-0',
'18746-63-9',
'18750-95-3',
'18773-03-0',
'18773-04-1',
'187863-42-9',
'18820-83-2',
'18827-81-1',
'1885-13-8',
'188589-32-4',
'1887136-01-7',
'1887136-03-9',
'1890136-54-5',
'18917-91-4',
'189263-81-8',
'189363-47-1',
'18958-57-1',
'18959-30-3',
'189750-98-9',
'18979-50-5',
'1898-66-4',
'19004-19-4',
'19053-14-6',
'1906-79-2',
'1906900-37-5',
'190974-21-1',
'191-07-1',
'19111-87-6',
'19168-23-1',
'1919055-55-2',
'19205-19-7',
'192198-85-9',
'1923-70-2',
'192998-62-2',
'193214-24-3',
'1934-75-4',
'19404-18-3',
'19423-81-5',
'1942879-46-0',
'194292-84-7',
'19482-05-4',
'195062-57-8',
'195443-34-6',
'195456-48-5',
'19598-90-4',
'196207-58-6',
'196212-27-8',
'197770-48-2',
'19832-87-2',
'19833-78-4',
'198-55-0',
'199121-98-7',
'200052-70-6',
'200068-36-6',
'200698-05-1',
'201802-15-5',
'201802-67-7',
'202126-48-5',
'202126-51-0',
'202268-34-6',
'2029196-34-5',
'20302-14-1',
'203389-28-0',
'203450-08-2',
'20441-06-9',
'20442-79-9',
'20445-88-9',
'20445-94-7',
'20466-00-6',
'2050-15-9',
'205-39-0',
'20548-54-3',
'205508-75-4',
'205806-87-7',
'205877-26-5',
'20651-71-2',
'2065-66-9',
'2065-67-0',
'207121-39-9',
'207347-46-4',
'207398-97-8',
'207611-87-8',
'207739-72-8',
'207861-55-0',
'2085-33-8',
'208709-55-1',
'2093414-16-3',
'2096495-59-7',
'2096495-60-0',
'2097121-30-5',
'2097938-53-7',
'2098786-35-5',
'209980-53-0',
'20999-38-6',
'21007-37-4',
'210347-56-1',
'210354-17-9',
'210409-12-4',
'21041-93-0',
'210471-34-4',
'2105-94-4',
'210705-84-3',
'21109-95-5',
'2111824-48-5',
'2113-51-1',
'211737-28-9',
'21324-39-0',
'21324-40-3',
'213-46-7',
'21351-79-1',
'2138-24-1',
'2141-62-0',
'2146-07-8',
'2153504-15-3',
'2154-68-9',
'216299-72-8',
'21643-38-9',
'21651-19-4',
'2169-87-1',
'2173111-73-2',
'2181-42-2',
'218151-78-1',
'21815-91-8',
'22034-43-1',
'22112-79-4',
'22112-83-0',
'221176-50-7',
'2215-89-6',
'222319-05-3',
'22237-13-4',
'222404-02-6',
'2226-96-2',
'22291-04-9',
'223437-05-6',
'2243-62-1',
'22519-64-8',
'22691-02-7',
'2269-22-9',
'2270172-94-4',
'227-09-8',
'227617-70-1',
'22803-05-0',
'22843-73-8',
'22886-66-4',
'2294-38-4',
'2294-76-0',
'2305-32-0',
'2312-14-3',
'23145-07-5',
'23271-47-8',
'23315-55-1',
'23449-08-3',
'2345-34-8',
'23467-27-8',
'236389-21-2',
'2370-18-5',
'23703-22-2',
'2370885-20-2',
'2377770-18-6',
'23906-97-0',
'239075-02-6',
'2397-00-4',
'24083-13-4',
'2417-00-7',
'24304-00-5',
'2432-11-3',
'243-59-4',
'244193-48-4',
'244193-50-8',
'244193-52-0',
'244193-56-4',
'244193-64-4',
'244234-52-4',
'244-63-3',
'244-69-9',
'24470-78-8',
'244761-29-3',
'244-76-8',
'245-08-9',
'2455-14-3',
'24672-76-2',
'247058-06-6',
'24742-30-1',
'24803-99-4',
'24804-00-0',
'248-70-4',
'248936-60-9',
'2493-84-7',
'249609-49-2',
'2498-20-6',
'25067-59-8',
'25078-04-0',
'25117-74-2',
'2512-56-3',
'25150-61-2',
'2516-92-9',
'2519-10-0',
'2521-07-5',
'2523-42-4',
'2528-38-3',
'25357-95-3',
'254755-24-3',
'25476-27-1',
'25510-41-2',
'2564-83-2',
'25700-11-2',
'25713-24-0',
'25729-12-8',
'25729-13-9',
'2579-20-6',
'2587-42-0',
'26106-63-8',
'26201-32-1',
'26204-55-7',
'2620-76-0',
'2622-74-4',
'26227-73-6',
'26444-49-5',
'2645-22-9',
'26576-85-2',
'26608-06-0',
'266349-83-1',
'26782-74-1',
'268536-05-6',
'26979-27-1',
'27176-87-0',
'273-09-6',
'273-13-2',
'273-15-4',
'27425-55-4',
'27485-15-0',
'27647-84-3',
'27848-80-2',
'27871-49-4',
'279246-65-0',
'280-57-9',
'28110-70-5',
'282118-14-3',
'28302-50-3',
'28788-62-7',
'2880-58-2',
'288071-87-4',
'28850-44-4',
'288627-94-1',
'28903-71-1',
'2896-70-0',
'290-37-9',
'2915-16-4',
'29162-73-0',
'29170-08-9',
'29176-55-4',
'2922-61-4',
'29261-33-4',
'2932-65-2',
'29509-91-9',
'29552-58-7',
'29726-21-4',
'29743-08-6',
'301-04-2',
'3017-60-5',
'302912-34-1',
'303111-06-0',
'303186-19-8',
'303186-20-1',
'30321-74-5',
'304680-35-1',
'304680-36-2',
'3047-99-2',
'3058-39-7',
'30633-94-4',
'306769-48-2',
'30734-07-7',
'30745-55-2',
'3085-79-8',
'3109-63-5',
'3112-31-0',
'3115-68-2',
'3117-03-1',
'31183-11-6',
'31248-39-2',
'31274-51-8',
'31366-25-3',
'31410-07-8',
'3164-13-4',
'31643-49-9',
'317830-83-4',
'319430-87-0',
'319476-28-3',
'32195-55-4',
'322413-12-7',
'3225-26-1',
'32353-49-4',
'32353-50-7',
'324575-10-2',
'325129-69-9',
'3264-82-2',
'32653-32-0',
'32703-80-3',
'327-51-5',
'3275-24-9',
'3282-11-9',
'3282-24-4',
'3283-05-4',
'32863-32-4',
'32870-98-7',
'3287-99-8',
'329-15-7',
'33027-66-6',
'33027-68-8',
'330671-29-9',
'330680-46-1',
'331465-73-7',
'3317-67-7',
'332-25-2',
'33228-44-3',
'33228-45-4',
'333-20-0',
'333432-27-2',
'33421-40-8',
'33454-82-9',
'334658-75-2',
'3365-85-3',
'3386-87-6',
'33926-25-9',
'33926-46-4',
'34099-97-3',
'34128-02-4',
'34151-49-0',
'34171-69-2',
'3419-99-6',
'34244-15-0',
'342638-54-4',
'342789-81-5',
'343239-58-7',
'343851-31-0',
'346417-97-8',
'34671-83-5',
'34699-28-0',
'34993-56-1',
'350042-00-1',
'350493-08-2',
'35280-78-5',
'353239-08-4',
'3535-83-9',
'35438-63-2',
'35466-87-6',
'35487-17-3',
'355-86-2',
'357219-41-1',
'3575-31-3',
'357645-40-0',
'358-63-4',
'358727-55-6',
'3588-17-8',
'35895-70-6',
'35935-34-3',
'359415-47-7',
'359845-21-9',
'3599-32-4',
'361486-60-4',
'364044-44-0',
'36405-17-1',
'36410-81-8',
'365549-33-3',
'365564-05-2',
'36603-80-2',
'366-18-7',
'3674-54-2',
'36775-23-2',
'36823-88-8',
'3685-22-1',
'3685-26-5',
'36945-08-1',
'37075-25-5',
'37149-18-1',
'3724-52-5',
'372956-40-6',
'374564-83-7',
'374592-88-8',
'37488-40-7',
'37529-27-4',
'376367-93-0',
'376609-78-8',
'3779-27-9',
'37920-25-5',
'38019-09-9',
'380497-17-6',
'38078-71-6',
'3813-52-3',
'38172-19-9',
'382150-50-7',
'38215-36-0',
'38215-38-2',
'38245-36-2',
'38257-52-2',
'38289-27-9',
'38289-28-0',
'38289-29-1',
'38303-35-4',
'3842-55-5',
'38444-13-2',
'38454-28-3',
'38465-55-3',
'385810-21-9',
'38582-73-9',
'3858-78-4',
'38690-76-5',
'38932-80-8',
'39001-64-4',
'3922-40-5',
'39253-43-5',
'39269-10-8',
'393870-04-7',
'39557-45-4',
'3958-82-5',
'3967-54-2',
'3971-31-1',
'3978-81-2',
'39795-60-3',
'398128-09-1',
'39969-28-3',
'401788-99-6',
'40210-84-2',
'40230-24-8',
'402846-78-0',
'403-43-0',
'403483-19-2',
'403842-84-2',
'404001-48-5',
'40503-90-0',
'405165-12-0',
'405165-14-2',
'405514-94-5',
'40649-36-3',
'406726-92-9',
'40680-45-3',
'4081-00-9',
'40817-08-1',
'40882-83-5',
'40904-90-3',
'409071-16-5',
'409-21-2',
'41044-12-6',
'41105-35-5',
'41122-70-7',
'41122-71-8',
'412009-61-1',
'41267-76-9',
'41424-11-7',
'41492-05-1',
'4151-80-8',
'41699-93-8',
'4181-20-8',
'41934-47-8',
'419536-33-7',
'4199-89-7',
'42072-39-9',
'42224-53-3',
'422269-95-2',
'42333-78-8',
'42539-74-2',
'427882-84-6',
'42815-59-8',
'4282-31-9',
'429-06-1',
'429-42-5',
'4316-23-8',
'4328-13-6',
'4329-78-6',
'4331-54-8',
'433337-11-2',
'433337-23-6',
'4333-62-4',
'4344-55-2',
'4373-60-8',
'4373-72-2',
'4385-76-6',
'4397-53-9',
'4411-80-7',
'4422-32-6',
'4427-96-7',
'4433-01-6',
'4479-74-7',
'448245-52-1',
'4485-12-5',
'4499-83-6',
'45361-12-4',
'454676-27-8',
'45492-87-3',
'45497-73-2',
'455-13-0',
'455-14-1',
'45579-91-7',
'45650-35-9',
'457613-56-8',
'457931-23-6',
'4584-63-8',
'459-19-8',
'459-57-4',
'460-08-2',
'46022-05-3',
'460345-16-8',
'4627-22-9',
'46331-50-4',
'47162-00-5',
'4733-39-5',
'4736-60-1',
'473717-08-7',
'475460-77-6',
'475681-62-0',
'476360-83-5',
'477908-53-5',
'47797-98-8',
'478706-06-8',
'4792-83-0',
'4805-22-5',
'480996-05-2',
'482-05-3',
'4853-74-1',
'4854-84-6',
'488-48-2',
'4891-44-5',
'490-11-9',
'4905-83-3',
'4916-57-8',
'493-77-6',
'4948-15-6',
'49563-87-3',
'49638-64-4',
'4965-17-7',
'496-74-2',
'499-80-9',
'499-81-0',
'499-83-2',
'50-01-1',
'500199-09-7',
'502161-03-7',
'502693-09-6',
'5041-09-8',
'50446-44-1',
'50480-99-4',
'50481-01-1',
'50548-45-3',
'50606-96-7',
'50649-64-4',
'506-58-1',
'50687-62-2',
'50802-52-3',
'51066-74-1',
'510775-24-3',
'51128-24-6',
'5122-99-6',
'512-56-1',
'51325-91-8',
'51325-95-2',
'514188-77-3',
'5144-89-8',
'51501-77-0',
'51554-93-9',
'51554-94-0',
'51554-95-1',
'5156-01-4',
'517-51-1',
'517-60-2',
'51760-21-5',
'51762-67-5',
'51870-56-5',
'518997-91-6',
'519054-55-8',
'51-93-4',
'51937-85-0',
'52198-63-7',
'523-27-3',
'52364-71-3',
'52364-72-4',
'52364-73-5',
'52709-83-8',
'52709-84-9',
'52709-85-0',
'52709-86-1',
'52709-87-2',
'527-21-9',
'527-61-7',
'52805-36-4',
'5283-66-9',
'528-44-9',
'528543-96-6',
'52927-22-7',
'53034-38-1',
'53159-92-5',
'53348-05-3',
'5337-36-0',
'534-17-8',
'53518-14-2',
'53518-18-6',
'53721-12-3',
'5379-77-1',
'5381-20-4',
'53916-94-2',
'540-38-5',
'540466-42-0',
'54053-45-1',
'5408-56-0',
'541-23-1',
'542-11-0',
'54211-46-0',
'5424-78-2',
'542-52-9',
'54258-41-2',
'54296-25-2',
'5434-20-8',
'5434-21-9',
'544-13-8',
'5441-51-0',
'544-40-1',
'54581-69-0',
'5467-74-3',
'54678-23-8',
'546-89-4',
'5472-23-1',
'54723-94-3',
'5487-93-4',
'55035-42-2',
'55035-43-3',
'550378-78-4',
'55135-66-5',
'5521-31-3',
'55-22-1',
'5522-43-0',
'5522-66-7',
'55266-17-6',
'553-12-8',
'553-26-4',
'553-54-8',
'55401-12-2',
'55492-86-9',
'5550-08-3',
'555-31-7',
'556-53-6',
'557-66-4',
'557788-37-1',
'55810-80-5',
'55873-21-7',
'5593-70-4',
'56047-84-8',
'56181-49-8',
'5624-60-2',
'563-04-2',
'56316-86-0',
'5632-29-1',
'56420-24-7',
'5660-45-7',
'56643-83-5',
'566939-58-0',
'56765-79-8',
'56-89-3',
'569-51-7',
'5700-49-2',
'570-22-9',
'570414-33-4',
'57102-62-2',
'57103-15-8',
'571177-69-0',
'57125-49-2',
'57125-50-5',
'573-17-1',
'5736-88-9',
'5736-89-0',
'5748-42-5',
'574-93-6',
'57654-36-1',
'57702-65-5',
'57803-73-3',
'57842-27-0',
'57848-46-1',
'578715-23-8',
'5810-42-4',
'58139-59-6',
'581-46-4',
'581-47-5',
'58328-31-7',
'58464-45-2',
'58464-47-4',
'58473-78-2',
'58536-46-2',
'58618-91-0',
'586-35-6',
'586-75-4',
'586-76-5',
'586-89-0',
'586-91-4',
'58743-78-5',
'58743-81-0',
'58791-49-4',
'589-16-2',
'58932-13-1',
'59061-53-9',
'59089-89-3',
'593-55-5',
'593-84-0',
'59-67-6',
'597554-03-5',
'597554-76-2',
'5978-70-1',
'598-03-8',
'5981-09-9',
'59813-05-7',
'598-62-9',
'598-63-0',
'6018-89-9',
'60239-18-1',
'603-11-2',
'604-32-0',
'60469-70-7',
'6047-25-2',
'604785-54-8',
'60484-67-5',
'6051-66-7',
'60532-63-0',
'605-70-9',
'605-94-7',
'606129-89-9',
'6068-72-0',
'60762-85-8',
'607740-08-9',
'6080-56-4',
'609771-63-3',
'610-09-3',
'610-27-5',
'610-29-7',
'610-35-5',
'610-49-1',
'6108-23-2',
'61203-83-6',
'61203-99-4',
'61204-00-0',
'61204-01-1',
'613-08-1',
'61326-44-1',
'61485-46-9',
'6153-56-6',
'61540-63-4',
'61545-99-1',
'61546-00-7',
'61586-86-5',
'615-93-0',
'616-38-6',
'616-42-2',
'6169-06-8',
'61755-34-8',
'618442-57-2',
'618-83-7',
'618-88-2',
'619-58-9',
'619-81-8',
'619-82-9',
'619-86-3',
'620624-96-6',
'620-84-8',
'620-93-9',
'62162-97-4',
'62217-35-0',
'622-62-8',
'623-00-7',
'62325-30-8',
'623-53-0',
'624-31-7',
'62452-73-7',
'624-59-9',
'6251-01-0',
'62-55-5',
'62608-15-5',
'62716-65-8',
'6274-12-0',
'627-95-2',
'628336-95-8',
'62940-38-9',
'6313-33-3',
'63139-21-9',
'631-40-3',
'631-61-8',
'63224-42-0',
'632-51-9',
'632-58-6',
'6326-64-3',
'63405-91-4',
'6364-19-8',
'6377-82-8',
'63782-74-1',
'63799-11-1',
'6421-04-1',
'6421-30-3',
'6424-77-7',
'64394-45-2',
'64394-47-4',
'64697-40-1',
'6477-29-8',
'64835-63-8',
'6485-97-8',
'65039-05-6',
'65039-08-9',
'65039-09-0',
'65039-10-3',
'65181-78-4',
'652-03-9',
'652145-28-3',
'652145-29-4',
'652-36-8',
'65344-26-5',
'65350-59-6',
'65353-51-7',
'65355-30-8',
'6543-20-0',
'65739-40-4',
'65756-41-4',
'65860-74-4',
'659-18-7',
'659-28-9',
'659-41-6',
'660-68-4',
'66127-00-2',
'66127-01-3',
'66489-68-7',
'666823-18-3',
'66-77-3',
'669072-93-9',
'66946-48-3',
'66946-49-4',
'66-99-9',
'670-54-2',
'6710-92-5',
'67-48-1',
'67589-39-3',
'67589-47-3',
'67605-64-5',
'676525-77-2',
'67-68-5',
'67-71-0',
'67908-87-6',
'6793-92-6',
'68007-08-9',
'68-04-2',
'68-05-3',
'68065-81-6',
'68-12-2',
'68128-94-9',
'6813-38-3',
'681481-91-4',
'681856-28-0',
'68271-98-7',
'682763-35-5',
'6833-47-2',
'68401-88-7',
'68449-38-7',
'68494-08-6',
'68550-20-9',
'68572-87-2',
'68585-82-0',
'68609-43-8',
'686290-22-2',
'68842-66-0',
'688-71-1',
'688-74-4',
'688756-58-3',
'689282-13-1',
'6912-12-5',
'6923-52-0',
'69240-56-8',
'69365-72-6',
'69367-32-4',
'69507-98-8',
'6959-71-3',
'696-62-8',
'6968-28-1',
'69857-37-0',
'699-08-1',
'70152-54-4',
'70247-25-5',
'70351-86-9',
'70351-87-0',
'7059-70-3',
'70800-59-8',
'7089-68-1',
'70948-71-9',
'709-63-7',
'71071-46-0',
'71101-89-8',
'711026-06-1',
'7116-16-7',
'7116-96-3',
'7128-64-5',
'7139-89-1',
'71410-72-5',
'715-50-4',
'71626-98-7',
'7182-86-7',
'71866-86-9',
'72076-09-6',
'7221-63-8',
'724792-82-9',
'72482-64-5',
'725-12-2',
'72688-90-5',
'72688-91-6',
'728911-52-2',
'72928-54-2',
'7310-97-6',
'7325-46-4',
'73276-70-7',
'73318-02-2',
'7334-94-3',
'7334-95-4',
'733744-98-4',
'7342-82-7',
'736998-56-4',
'73834-77-2',
'7396-41-0',
'74098-36-5',
'741677-68-9',
'742086-10-8',
'7424-70-6',
'7440-06-4',
'7440-55-3',
'744198-90-1',
'74448-92-3',
'7446-14-2',
'7446-20-0',
'7446-70-0',
'7447-39-4',
'7447-41-8',
'74962-29-1',
'749900-93-4',
'75-05-8',
'7511-49-1',
'7521-80-4',
'752-28-3',
'75232-44-9',
'75238-79-8',
'753489-02-0',
'7550-35-8',
'7550-45-0',
'75-58-1',
'7567-63-7',
'760212-40-6',
'760212-42-8',
'760212-58-6',
'76115-06-5',
'76185-65-4',
'76287-49-5',
'764-42-1',
'7646-79-9',
'7646-85-7',
'7647-17-8',
'76487-56-4',
'765910-73-4',
'766-96-1',
'767-00-0',
'76727-11-2',
'7681-65-4',
'768-60-5',
'7705-08-0',
'7722-76-1',
'7727-15-3',
'773881-43-9',
'775351-57-0',
'7758-88-5',
'7758-89-6',
'7758-94-3',
'7758-95-4',
'7758-98-7',
'7758-99-8',
'7782-49-2',
'7782-61-8',
'7782-64-1',
'7783-20-2',
'7783-28-0',
'7783-40-6',
'7783-50-8',
'7783-51-9',
'7783-53-1',
'7783-56-4',
'7783-63-3',
'7783-85-9',
'7784-18-1',
'7784-23-8',
'7784-27-2',
'7784-31-8',
'7785-20-8',
'7787-32-8',
'7787-35-1',
'7787-58-8',
'7787-60-2',
'7787-61-3',
'7787-64-6',
'7787-69-1',
'7787-70-4',
'7788-97-8',
'7789-02-8',
'7789-17-5',
'7789-19-7',
'7789-24-4',
'7789-28-8',
'7789-41-5',
'7789-45-9',
'7789-46-0',
'7789-75-5',
'779-03-3',
'7790-44-5',
'7790-76-3',
'7790-80-9',
'7790-86-5',
'7791-20-0',
'77989-15-2',
'7803-55-6',
'78151-58-3',
'782477-81-0',
'78-30-8',
'78-32-0',
'78-40-0',
'78-42-2',
'78-51-3',
'78560-45-9',
'78751-80-1',
'787-70-2',
'79534-91-1',
'79709-85-6',
'79757-77-0',
'797789-00-5',
'79887-09-5',
'79887-11-9',
'79887-14-2',
'79917-88-7',
'79917-89-8',
'79917-90-1',
'80223-29-6',
'803727-09-5',
'804560-00-7',
'80663-92-9',
'808142-23-6',
'808-57-1',
'80944-44-1',
'80984-79-8',
'81029-06-3',
'81090-53-1',
'81-30-1',
'81-33-4',
'81-88-9',
'81936-32-5',
'820965-08-0',
'82575-69-7',
'82575-70-0',
'82632-80-2',
'826-74-4',
'827320-59-2',
'82777-09-1',
'82832-27-7',
'82832-57-3',
'82832-58-4',
'82832-72-2',
'82832-73-3',
'82953-57-9',
'83242-83-5',
'83617-79-2',
'836-41-9',
'841251-37-4',
'84540-32-9',
'84540-37-4',
'84-58-2',
'84-60-6',
'84656-75-7',
'847264-30-6',
'848641-69-0',
'84976-67-0',
'85-01-8',
'850331-04-3',
'850583-75-4',
'85100-76-1',
'85100-77-2',
'85100-78-3',
'852620-97-4',
'85312-59-0',
'853-35-0',
'853-68-9',
'855766-92-6',
'85600-56-2',
'85642-11-1',
'85720-62-3',
'85734-18-5',
'85734-19-6',
'860465-14-1',
'860653-59-4',
'86100-63-2',
'864377-28-6',
'864377-31-1',
'86-57-7',
'866-97-7',
'867044-33-5',
'86-73-7',
'86-76-0',
'86776-50-3',
'86776-52-5',
'868850-50-4',
'870774-25-7',
'871466-65-8',
'871696-12-7',
'872-36-6',
'872466-50-7',
'87260-24-0',
'872672-50-9',
'872-93-5',
'87321-20-8',
'874-60-2',
'874-86-2',
'874-90-8',
'87592-41-4',
'87666-86-2',
'878027-73-7',
'879360-14-2',
'88038-94-2',
'88074-73-1',
'881913-20-8',
'882659-01-0',
'88493-55-4',
'88535-47-1',
'88581-00-4',
'886456-80-0',
'88754-66-9',
'888041-37-0',
'888-12-0',
'88840-42-0',
'88-99-3',
'890042-13-4',
'89-00-9',
'89-01-0',
'89-05-4',
'890704-02-6',
'89088-95-9',
'89111-63-7',
'89114-74-9',
'897671-79-3',
'897921-59-4',
'89827-45-2',
'89972-75-8',
'89972-76-9',
'90076-65-6',
'900795-73-5',
'900806-58-8',
'90-11-9',
'90-14-2',
'90384-82-0',
'905-62-4',
'906478-91-9',
'90774-69-9',
'909390-59-6',
'910058-11-6',
'911303-46-3',
'91-15-6',
'91328-77-7',
'913738-04-2',
'91-44-1',
'916061-87-5',
'916849-52-0',
'917-23-7',
'91742-16-4',
'91742-21-1',
'92-24-0',
'92413-47-3',
'92638-81-8',
'926643-78-9',
'927021-43-0',
'928170-42-7',
'930-35-8',
'932739-76-9',
'933047-52-0',
'934-31-6',
'934365-16-9',
'935-14-8',
'940-71-6',
'94280-72-5',
'94288-44-5',
'94288-45-6',
'943298-08-6',
'943-89-5',
'95051-10-8',
'950761-81-6',
'952155-74-7',
'952431-34-4',
'952514-79-3',
'952514-86-2',
'95407-69-5',
'955959-84-9',
'95689-92-2',
'957014-38-9',
'95759-44-7',
'95759-51-6',
'958101-27-4',
'958261-50-2',
'958261-51-3',
'959-36-4',
'95950-70-2',
'959698-44-3',
'96131-57-6',
'96184-40-6',
'96184-42-8',
'96404-79-4',
'96-48-0',
'96-49-1',
'96761-85-2',
'97345-90-9',
'97398-80-6',
'979-88-4',
'98437-24-2',
'98837-51-5',
'98892-75-2',
'98-98-6',
'98997-63-8',
'99163-12-9',
'99257-94-0',
'99-31-0',
'996-70-3',
'99685-96-8',
'99762-80-8',
'99770-93-1',
'99-90-1',
'99-91-2',
'99970-84-0'
]	
# getProductInfo("https://pubchem.ncbi.nlm.nih.gov/rest/pug_view/data/compound/10864923/JSON/",'t', products)
for cas in cass:
	getProductList(cas,products)

headers=['cas','cid','InChI','InChIKey']
rindex = 1
for p in products:
	writeExcel(workSheet, headers, rindex, p)
	if rindex%100  == 0:
		wb.save(excelFileName)
	rindex = rindex+1
print("flish")	

wb.save(excelFileName)